---
title: " Project Report"
output: 
  html_document: 
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: true
---

```{r setup, message = FALSE, echo = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(ggridges)
library(patchwork)
library(plotly)

knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

```{r merged data, message = FALSE, echo = FALSE}
merged = read_csv("data/master.csv") %>% 
  janitor::clean_names()
```

&nbsp; 

# Motivation
***

In 2019, many states raced to enact an unprecedented wave of bans on abortions that have severely restricted Women’s reproductive rights. These restrictions have culminated to the recent Supreme Court overturning of Roe v. Wade, a landmark supreme court case granting a women’s right to an abortion. 

<img src="images/2019_abortion.jpg" style = "width:70%">

Source: [Guttmacher Institute](https://www.guttmacher.org/article/2019/12/state-policy-trends-2019-wave-abortion-bans-some-states-are-fighting-back)

Our year of interest is 2019, which is the most recent dataset provided by New York State and the final year before the COVID-19 pandemic. We will be focusing on the number of induced abortions per 1,000 live births in New York City and New York State and compare the differences across boroughs (for New York City), counties (for New York State), and between New York City and New York State. Variables we are considering are age, race/ethnicity, and financial plans (a.k.a. insurance plans). Those that are likely to be most impacted by this decision are individuals that belong to under-served and marginalized communities. We wanted to better understand disparities in abortion access.

&nbsp; 

# Initial questions
***
Originally, we wanted to conduct a comparative analysis of abortion rates in New York and Mississippi from 2017-2020 to answer the following questions:

* Have abortion rates changed over time (2017 to 2020) in New York and Mississippi?
* What does the distribution of abortion rates between counties within New York and Mississippi look like?
* Are abortion rates different in New York compared to Mississippi while accounting for age, race/ethnicity, method, and insurance plan?


# Final Research Questions
***
We were unable to find a comprehensive dataset that included individual level data needed to answer these questions. Therefore, we decided to focus on conducting an analysis of abortion rates in New York City and New York State in 2019. Our research questions changed to the following:

* What does the distribution of rates of abortion between boroughs within New York City look like in 2019?
  * Are abortion rates different among boroughs in New York City while accounting for age, race/ethnicity, and finance plans in 2019?
* How do abortion rates differ between New York City and New York State in 2019?
* How do abortion rates differ within regions/counties of New York State in 2019?
  * Are abortion rates different among regions/counties of New York State while accounting for age, race/ethnicity, and finance plans?

&nbsp; 

# Data
***

## Source

For this project, we will use data from [Vital Statistics of New York State 2014-2019](https://www.health.ny.gov/statistics/vital_statistics/) which consists of group-level data from New York City and New York State for age, race/ethnicity, and finance plans, each being its own data set. 

- The data were collected from the New York State Bureau of Vital Records who maintains a registry of all births, marriages, divorces/dissolutions of marriage, deaths, induced termination of pregnancy/abortions, and fetal deaths that have occurred in New York State. 

- The [New York City Department of Health and Mental Hygiene](https://www.health.ny.gov/health_care/medicaid/redesign/ehr/registry/nycdohmh.htm) sends data on on live births, deaths, fetal deaths, induced terminations of pregnancy/abortions (abortion), marriages, and divorces/dissolutions of marriage recorded in New York City to the New York State Department of Health. 

- The New York State Department of Health receives data on live births and deaths recorded outside of New York State to residents of New York State from other states and Canada.

- The geographical units are categorized as follows:

  - New York City includes five counties: Bronx, Kings (Brooklyn), New York (Manhattan), Queens, and Richmond (Staten Island). Each county corresponds to a borough.
  
  - New York State encompasses 10 regions: Central New York, Eastern Adirondacks, Western Adirondacks, Saratoga, Finger Lakes, Western New York, Hudson Valley, Westchester/Rockland, Long Island, and New York City.

  - New York State encompasses 62 counties, including five from New York City.

From the Vital Statistics of New York State 2019, we will use data from the *Induced Abortions* and *Live Births* section in order to find information on finance plans. 

## Data Scraping and Cleaning 

We first imported the data sets representing abortion rates from the Vital Statistics of New York State 2019 webpage. We cleaned and merged the data appropriately to create a final master spreadsheet, which we will be pulling from for each of our analyses.

For the finance plans data set, we imported the number of induced abortion and number of live births in order to calculate the abortion rates manually. The equation we used is as follows:

$$Abortion\ Rate\ per\ 1000\ Live\ Births\ = \frac{Count}{Number\ of\ Live\ Births} \times 1000$$

We renamed variable names for the different counties in New York City to the name of the respective boroughs. Final variable names in our dataset for New York City include:

- `Manhattan`
- `Bronx`
- `Brooklyn`
- `Queens`
- `Staten Island` 

From the same dataset, we included `New York State` total, `New York City` total and any county with released abortion rate data. Therefore, the dataset includes the following variables: `r merged %>% pull(borough)`to analyze data for New York state. 

One note is that Essex County and Hamilton County data are combined in the dataset provided by New York state. Therefore, `Essex/Hamilton` is used as a combined variable, rather than separate variables.

Counties were recoded into regions based on categories set by New York State using `transform` or `case_when`. Some counties had very few abortion numbers, which would not provide a sufficient sample size when stratifying based on our covariates. As a result, the categorizing of the regions will ensure a sufficient sample size for some of the analyses.

The final regions included in the dataset for New York State includes:

- `Central New York`
- `Eastern Adirondacks`
- `Western Adirondacks`
- `Saratoga`
- `Finger Lakes`
- `Western New York`
- `Hudson Valley`
- `Westchester/Rockland`
- `Long Island`
- `New York City`

The regions were created based on this [website](https://statejobs.ny.gov/assets/help/regionMapText.cfm)

Specific data cleaning processes for the covariates are listed below.

### Age

Age was categorized as follows:

- `age_less_20`
- `age_20_24`
- `age_25_29`
- `age_30_34`
- `age_35_39`
- `age_plus_40`

### Race/Ethnicity

Race/Ethnicity was categorized as follows:

- `Non-Hispanic White`
- `Non-Hispanic Black` 
- `Non-Hispanic Others` 
- `Hispanic`

Ethnicity is distinguished from race and is based on the ethnicity of the mother. Ethnicity distinguishes individuals of Spanish origin regardless of race. Race was self-reported. 
 
### Financial Plan Status

The final variable names include:

- `Medicaid`
- `Other_insurance`
- `self_pay`
- `not stated`

The technical notes in the dataset did not specify which plans were included under the `other_insurance` category. 

After individual datasets were tidied, they were merged into a final dataset which was then saved and exported to our project repository. These steps were necessary to ensure that the code was readable and reproducible. 

### Final Dataset

Here is our final, cleaned and tidied dataset: 

```{r}
final= 
  merged %>%
  select(borough, region, total, everything()) %>%
  mutate_if(is.numeric,
            round,
            digits = 1)

final_table= 
  kableExtra::kable(cbind(final), align = 'llcccccccccccccccc', col.names = c("Borough", "Region", "Total","<20","20-24","25-29","30-34","35-39","40+", "Non-Hipanic Total", "Non-Hispanic White", "Non-Hispanic Black", "Non-Hispanic Other", "Hispanic Total", "Hispanic White", "Hispanic Black", "Medicaid", "Self-Pay", "Other Insurance", "Not Stated")) %>%
  kableExtra::kable_styling() %>%
  kableExtra::scroll_box(width = "800px", height = "400px")

final_table
```

&nbsp; 

# Exploratory analysis
***

Our exploratory analysis was split into two categories - [New York State](ny_exploratory_analysis.html) and [New York City](nyc_exploratory_analysis.html). We analyzed how abortion rates may differ across our covariates (Age, Race/Ethnicity and Financial Plan Status), using plots created via `plotly`. All plots seen here have been made using `ggplot`. For interactive plots, head over to the individual exploratory analyses pages linked above! 

## NYC Analysis Results:

&nbsp; 

### Age:

```{r}
age_nyc = 
  merged %>%
  select(1:7) %>%
  slice(3:7)

age_nyc %>%
  pivot_longer(
    age_less_20:age_plus_40,
    names_to = "age", 
    values_to = "abortion",
    names_prefix = "age_"
  ) %>%
  mutate(
    age = replace(age, age == "less_20", "<20"),
    age = replace(age, age == "20_24", "20-24"),
    age = replace(age, age == "25_29", "25-29"),
    age = replace(age, age == "30_34", "30-34"),
    age = replace(age, age == "35_39", "35-39"),
    age = replace(age, age == "plus_40", "40+"),
    age = factor(age)
  ) %>%
  ggplot(aes(x = age, y = abortion, fill= borough, color= borough)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NYC by Age",
    x = "Age (Years)",
    y = "Abortions per 1,000 Live Births"
    )
```

From the bar plots, it is evident that those who are less than 20 years of age have the highest abortion rates across the boroughs in New York City in 2019. These rates decrease as age categories increase. When comparing between boroughs, Manhattan had the highest abortion rates in categories `<20` and `25-29`. Staten Island had the lowest abortion rates overall, except for category `20-24`. The highest abortion rate across all boroughs and age categories was for Manhattan for `< 20` with 1,964.9 induced abortions per 1,000 live births. The lowest abortion rate across all boroughs and age categories was in Staten Island for `35-39` with 130 induced abortions per 1,000 live births. 

### Race/Ethnicity:

```{r}
race_nyc = 
  merged %>%
  select(1,9:12) %>%
  slice(3:7)

race_nyc %>%
  pivot_longer(
    nh_white_only_ratio:h_total,
    names_to = "race", 
    values_to = "abortion"
  ) %>%
    mutate(
    race = replace(race, race == "nh_white_only_ratio", "Non-Hispanic White Only"),
    race = replace(race, race == "nh_black_only_ratio", "Non-Hispanic Black Only"),
    race = replace(race, race == "nh_other_ratio", "Non-Hispanic Other"),
    race = replace(race, race == "h_total", "Hispanic"),
    race = factor(race)
    ) %>%
  ggplot(aes(x = race, y = abortion, fill= borough, color= borough)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NYC by Race/Ethnicity",
    x = "Race/Ethnicity",
    y = "Abortions per 1,000 Live Births"
    )
```

From the bar plots, it is evident that those who identified as Non-Hispanic Black had the highest abortion rates across all boroughs in NYC. Among those who identified as Non-Hispanic Black, abortion rates were highest in Manhattan with 1,228.3 induced abortions per 1,000 live births. Those who identified as Non-Hispanic White and Non-Hispanic Other had some of the lowest abortion rates in NYC. The lowest rates across all boroughs and race groups was for those who identified as Non-Hispanic White and lived in Brooklyn with a rates of 88.6 induced abortions per 1,000 live births. 

### Financial Plan Status:

```{r}
finance_plan_nyc= 
  merged %>%
  select(1,15:18) %>%
  slice(3:7)

finance_plan_nyc %>%  
  pivot_longer(
    medicaid:not_stated,
    names_to = "finance_plan", 
    values_to = "abortion"
  ) %>%
 mutate(
    finance_plan = replace(finance_plan, finance_plan == "medicaid", "Medicaid"),
    finance_plan = replace(finance_plan, finance_plan == "self_pay", "Self Pay"),
    finance_plan = replace(finance_plan, finance_plan == "other_insurance", "Other Insurance"),
    finance_plan = replace(finance_plan, finance_plan == "not_stated", "Not Stated"),
    finance_plan = factor(finance_plan)
    )%>%
  ggplot(aes(x = finance_plan, y = abortion, fill= borough, color= borough)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NYC by Financial Plan",
    x = "Financial Plan Status",
    y = "Abortions per 1,000 Live Births"
    )
```

From the bar plots, those who were categorized as having Other Insurance had the highest abortion rates across all financial plans in NYC with a rate of 62.86k induced abortions per 1000 live births. When calculating abortion rates for financial plans, we manually calculated these rates from (induced abortions/ live births)*1000 as they were not provided like in other data sets. An noticeable trend is that those who have induced abortions and those who give births tend to use different insurance plans. People who give birth are unlikely to use `Other Insurance` in comparison to those who have induced abortions due to inherent differences in procedures. Those who used `Self Pay` for induced abortions had a relatively high abortion rates as well. This would make sense given the nature of the procedure and possible restrictions by the health insurance plan to cover abortions. Medicaid had the lowest abortion rates across all financial plans, and the rates were lowest with 287 induced abortions per 1,000 live births.

&nbsp; 

## NY State Analysis Results 

&nbsp; 

### Age 

```{r}
age_nys = 
  merged %>%
  select(region, starts_with("age")) %>% 
  pivot_longer(
    age_less_20:age_plus_40,
    names_to = "age", 
    values_to = "abortion",
    names_prefix = "age_"
  ) %>% 
  mutate(
    age = replace(age, age == "less_20", "<20"),
    age = replace(age, age == "20_24", "20-24"),
    age = replace(age, age == "25_29", "25-29"),
    age = replace(age, age == "30_34", "30-34"),
    age = replace(age, age == "35_39", "35-39"),
    age = replace(age, age == "plus_40", "40+"),
    age = factor(age)
  ) %>%
  group_by(region,age)%>%
  summarise(total = sum(abortion)) %>% 
  ggplot(aes(x = age, y = total, fill= region, color= region)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NY State by Age",
    x = "Age (Years)",
    y = "Abortions per 1,000 Live Births"
    )

age_nys  
```

From the above plot, it is evident that within different categories of age, the highest abortion rate per 1,000 live births is among those that are below 20 years of age. We see a decline in induced abortion rates among older people across all regions within New York State. The highest abortion rate is found among those in New York City who are less than 20 years of age with 7,677.5 induces abortions per 1,000 live births. While New York city has higher abortion rates across most age categories, we see that among those that are 35+, higher rates of abortion are found among those in the Finger Lakes, Capital/Saratoga, and Central New York regions.

### Race/Ethnicity

```{r}
race_nys = 
  merged %>%
  select(region, nh_white_only_ratio:h_total) %>%
  pivot_longer(
    nh_white_only_ratio:h_total,
    names_to = "race", 
    values_to = "abortion"
    ) %>%
  mutate(
    race = replace(race, race == "nh_white_only_ratio", "Non-Hispanic White Only"),
    race = replace(race, race == "nh_black_only_ratio", "Non-Hispanic Black Only"),
    race = replace(race, race == "nh_other_ratio", "Non-Hispanic Other"),
    race = replace(race, race == "h_total", "Hispanic"),
    race = factor(race)
    ) %>%
  group_by(region,race)%>%
  summarise(total = sum(abortion)) %>% 
  ggplot(aes(x = race, y = total, fill= region, color= region)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NY State by Race/Ethnicity",
    x = "Race/Ethnicity",
    y = "Abortions per 1,000 Live Births"
    )

race_nys 
```

When looking at abortion rates within different race/ethnicity categories, we observe that the highest rates of abortion are among those who identify as Non-Hispanic Black. The highest abortion rate is among those residing in New York City and identify as Non-Hispanic Black with 4,638.1 induced abortions per 1,000 live births. Hispanic individuals also have high abortion rates, with the highest abortion rate within this category among those that reside in the Capital/ Saratoga region (3,698.2 per 1000 live births). 

### Financial Plan Status

```{r}
finance_nys = 
  merged %>%
  select(region, medicaid:not_stated) %>%
  pivot_longer(
    medicaid:not_stated,
    names_to = "finance_plan", 
    values_to = "abortion"
  ) %>% 
  mutate(
    finance_plan = replace(finance_plan, finance_plan == "medicaid", "Medicaid"),
    finance_plan = replace(finance_plan, finance_plan == "self_pay", "Self Pay"),
    finance_plan = replace(finance_plan, finance_plan == "other_insurance", "Other Insurance"),
    finance_plan = replace(finance_plan, finance_plan == "not_stated", "Not Stated"),
    finance_plan = factor(finance_plan)
    ) %>%
  group_by(region,finance_plan)%>%
  summarise(total = sum(abortion)) %>% 
  ggplot(aes(x = finance_plan, y = total, fill= region, color= region)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NY State by Financial Plan Status",
    x = "Financial Plan",
    y = "Abortions per 1,000 Live Births"
    )

```

Highest abortion rates are found among those enrolled in the `Not Stated` insurance category, followed by the `Other Insurance` category. The highest abortion rate, when stratified by insurance enrollment, is found among those residing in the Capital/Saratoga region, and reporting as `Not Stated` insurance category with 168.1k induced abortions per 1,000 live births. Within New York City, highest rates are found among those that are enrolled in `Other Category` insurance plans with a rate of 150.1k induced abortions per 1,000 live births. Lowest rates of abortion are found among those that are enrolled in Medicaid. 

&nbsp; 

## Comparing NYC and NY State

&nbsp; 

### NY vs NYC Age

```{r}
age_total = 
  merged %>%
  select(1:7) %>%
  slice(1:2)

age_total %>%
  pivot_longer(
    age_less_20:age_plus_40,
    names_to = "age", 
    names_prefix = "age_",
    values_to = "abortion"
  ) %>% 
  mutate(
    age = replace(age, age == "less_20", "<20"),
    age = replace(age, age == "20_24", "20-24"),
    age = replace(age, age == "25_29", "25-29"),
    age = replace(age, age == "30_34", "30-34"),
    age = replace(age, age == "35_39", "35-39"),
    age = replace(age, age == "plus_40", "40+"),
    age = factor(age)
  ) %>% 
  ggplot(aes(x = age, y = abortion, fill= borough, color= borough)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NYC Vs. NYS by Age",
    x = "Age (Years)",
    y = "Abortions per 1,000 Live Births"
    )

```

From the bar plots, it is evident that those in New York City have higher abortion rates compared to those in New York State across all age categories. Rates seem to decrease as age categories increase for New York City. However, for New York State, rates decrease from the <20 to 35-39 age categories, and increase among those who are 40+. Rates were highest among those who were <20 years for both New York City and New York State. Those <20 years in New York State had the highest rates across all categories of 1,491.4 abortions per 1,000 live births.

### NY vs. NYC Race

```{r}
race_total = 
  merged %>%
  select(1,9:12) %>%
  slice(1:2)

race_total %>%
  pivot_longer(
    nh_white_only_ratio:h_total,
    names_to = "race", 
    values_to = "abortion"
  ) %>%
  mutate(
    race = replace(race, race == "nh_white_only_ratio", "Non-Hispanic White Only"),
    race = replace(race, race == "nh_black_only_ratio", "Non-Hispanic Black Only"),
    race = replace(race, race == "nh_other_ratio", "Non-Hispanic Other"),
    race = replace(race, race == "h_total", "Hispanic"),
    race = factor(race)
    )%>% 
  ggplot(aes(x = race, y = abortion, fill= borough, color= borough)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NYC vs. NYS by Race/Ethnicity",
    x = "Race/Ethnicity",
    y = "Abortions per 1,000 Live Births"
    )

```

It is evident that those who identified as Non-Hispanic Black had the highest abortion rates across all boroughs in New York City. Among those who identified as Non-Hispanic Black, rates were highest in Manhattan with 851.7 induced abortions per 1,000 live births. Those who identified as Non-Hispanic White and Non-Hispanic Other had some of the lowest abortion rates in New York City. The lowest rates across all boroughs and race groups was for those who identified as Non-Hispanic White only and lived in Brooklyn with a rates of 142.9 induced abortions per 1,000 live births. 

### NY vs. NYC Financial Plans

```{r}
finance_plan_total= 
  merged %>%
  select(1,15:18) %>%
  slice(1:2)

finance_plan_total %>%  
  pivot_longer(
    medicaid:not_stated,
    names_to = "finance_plan", 
    values_to = "abortion"
  ) %>%
  mutate(
    finance_plan = replace(finance_plan, finance_plan == "medicaid", "Medicaid"),
    finance_plan = replace(finance_plan, finance_plan == "self_pay", "Self Pay"),
    finance_plan = replace(finance_plan, finance_plan == "other_insurance", "Other Insurance"),
    finance_plan = replace(finance_plan, finance_plan == "not_stated", "Not Stated"),
    finance_plan = factor(finance_plan)
    ) %>% 
  ggplot(aes(x = finance_plan, y = abortion, fill= borough, color= borough)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NYC vs. NYS by Financial Plan",
    x = "Financial Plan Status",
    y = "Abortions per 1,000 Live Births"
    )
```

Rates were highest for those with `Other Insurance` in both New York City and New York State and was higher in New York City with 19.92k induced abortions per 1,000 live births. Rates were lowest for those with Medicaid in both New York City and New York State and was lower for those in New York State with 325.66 induced abortions per 1,000 live births. 

## Dashboard

A [shiny dashboard](https://kasturi-b.shinyapps.io/shiny_dashboard_template/) was created using abortion rates from 2014 to 2019 for New York State counties to interactively explore different trends across categories. This dashboard includes a map displaying total abortion rates and two barplots showing the distribution of abortion rates for each county for the selected age group on the top and race/ethnicity categories at the bottom. 

Published data combined abortion rates for Essex County and Hamilton County. Therefore, abortion rates for Essex represent the abortion rates for both Essex and Hamilton, leaving Hamilton with no displayed data.

&nbsp; 

# Statistical Analysis
***
In addition to conducting an exploratory analysis to assess how abortion rates may have differed across boroughs, regions, and counties and across different categories of our covariates (Age, Race/Ethnicity and Financial Plan Status), we conducted a statistical analysis to assess whether or not the differences observed in the data occurred only by chance or due to our covariates. A proportion t-test was performed to assess if abortion rates differed across geographical units. A chi-squared test was performed to assess if abortion rates differed across geographical units adjusting for our covariates.
Because our final tidy dataset reports abortion rates standardized by 1000 live births, these points were converted back to abortion rates to run the chi-squared tests.

## Abortion Trends in NY State

&nbsp; 

### Proportion Test - NY State Regions

**Do overall abortion rates differ across NY state regions?**

**$H_0$**: The abortion rate per 1000 live births is the same across all NY state regions.

**$H_1$**: The abortion rate per 1000 live births is not the same across all NY state regions.

```{r data_NY, message=FALSE, include=FALSE}
NY_year = read_csv("data/NY_year.csv")
```

```{r tidy_NY}
# Tidy data
NY_totals =
  NY_year %>%
  select(borough, total) %>%
  slice(1:10) %>%
  mutate(
    n = total,
    total = 1000)

NY_totals %>% 
  select(-total) %>%
  knitr::kable(caption = "Proportion T-Test for NY across all Regions",
  col.names = c("Region", "Abortions per 1000 live births"), align = c('l', 'c'), format = "simple")
```

```{r prop_NY}
# Run 10 prop t-test
prop.test(NY_totals$n, NY_totals$total,
          p = NULL, alternative = "two.sided")
```

From the above results, **$X^2$ is greater than the test-statistic at the 5% level of significance**. Therefore, **we reject the null hypothesis.** The data provides sufficient evidence to support the hypothesis that overall abortion rates per 1,000 live births differs across NY state regions. Because this suggests that abortion rates differs across NY state regions, we now can assess whether or not this holds true across counties.

### Proportion Test - NY State Counties

**Do overall abortion rates differ across NY state counties?**

**$H_0$**: The abortion rates per 1000 live births is the same across all NY state counties.

**$H_1$**: The abortion rates per 1000 live births is not the same across all NY state counties.

```{r tidy_NY_counties}
# Tidy data
NY_totals_counties =
  merged %>%
  select(borough, total) %>%
  slice(-(1:2)) %>%
  mutate(
    n = total,
    total = 1000)

NY_totals_counties %>% 
  select(-total) %>%
  head(10) %>%
  knitr::kable(caption = "Proportion T-Test for NY across all Counties",
  col.names = c("County", "Abortions per 1000 live births"), align = c('l', 'c'), format = "simple")
```

Only the first 10 counties are printed.

```{r prop_NY_counties}
# Run 58 prop t-test
prop.test(NY_totals_counties$n, NY_totals_counties$total,
          p = NULL, alternative = "two.sided")
```

From the above results, **$X^2$ is greater than the test-statistic at the 5% level of significance**. Therefore, **we reject the null hypothesis.** The data provides sufficient evidence to support the hypothesis that overall abortion rates per 1,000 live births differs across NY state counties.

### Chi Square Test - Race and NY State Counties

Due to missing data, a chi-squared analysis was not run for race and NY state regions.

**Do overall abortion rates differ across NY state counties by race?**

**$H_0$**: The expected abortion rates in each race category are the same across all NY state counties.

**$H_1$**: The expected abortion rates in each race category are not the same across all NY state counties.

```{r NY_tidy_race_counties}
# Tidy data
NY_race_clean = 
  merged %>%
  slice(-(1:2)) %>%
  select(-(age_less_20:nh_total)) %>% select(-(h_white_only_ratio:region)) %>%
  drop_na() %>%
  mutate(
    hispanic = h_total*1000,
    nh_white_only = nh_white_only_ratio*1000,
    nh_black_only = nh_black_only_ratio*1000,
    nh_other = nh_other_ratio*1000
  ) %>%
  select(-(nh_white_only_ratio:h_total))

NY_race_clean %>% 
  head(10) %>%
  knitr::kable(caption = "Chi-Square Test for Race and Counties", col.names = c("County", "Hispanic", "Non-Hispanic White", "Non-Hispanic Black", "Non-Hispanic Other"), align = c('l', 'c', 'c', 'c', 'c','c','c'), format = "simple")
```

Only the first 10 counties are printed.

```{r NY_chi-sq_race_counties}
NY_race_clean =
  NY_race_clean %>%
  select(-borough)

# Run chi-square test
chisq.test(NY_race_clean)
```

```{r NY_x_crit_race_counties}
x_crit = qchisq(0.95, 135)
x_crit
```

From the above results, **$X^2$ is greater than the test-statistic at the 5% level of significance**. Therefore, **we reject the null hypothesis.** The data provides sufficient evidence to support the hypothesis that overall abortion rates in each race category across counties is different.

### Chi Square Test - Finance Plans and NY State Regions

**Do overall abortion rates differ across NY state regions by finance plan?**

**$H_0$**: The expected abortion rates in each finance plan category are the same across all NY state regions.

**$H_1$**: The expected abortion rates in each finance plan category are not the same across all NY state regions.

```{r data_NY_finance, include=FALSE, message=FALSE}
NY_finance = read_csv("data/NY_finance.csv")
```

```{r NY_tidy_finance}
# Tidy data
NY_finance_clean = 
  NY_finance %>%
  mutate(
    medicaid = medicaid*1000,
    self_pay = self_pay*1000,
    other_insurance = other_insurance*1000,
    not_stated = not_stated*1000
  ) %>%
  select(-total)

NY_finance_clean %>%
  knitr::kable(caption = "Chi-Square Test Finance Plan and Regions", col.names = c("Region", "Medicaid", "Self-Pay", "Other Insurance", "Not Stated"), align = c('l', 'c', 'c', 'c', 'c'), format = "simple" )
```

```{r NY_chi-sq_finance}
NY_finance_clean =
  NY_finance_clean %>%
  select(-borough)

# Run chi-square test
chisq.test(NY_finance_clean)
```

```{r NY_x_crit_finance}
x_crit = qchisq(0.95, 27)
x_crit
```

From the above results, **$X^2$ is greater than the test-statistic at the 5% level of significance**. Therefore, **we reject the null hypothesis.** The data provides sufficient evidence to support the hypothesis that overall abortion rates in each finance category across regions is different.

### Chi Square Test - Finance Plan and NY State Counties

**Do overall abortion rates differ across NY state counties by finance plan?**

**$H_0$**: The expected abortion rates in each finance plan category are the same across all NY state counties.

**$H_1$**: The expected abortion rates in each finance plan category are not the same across all NY state counties.

```{r NY_finance_counties}
# Tidy data
NY_finance_counties = 
  merged %>%
  slice(-(1:2)) %>%
  select(-(age_less_20:nh_total)) %>% select(-(h_white_only_ratio:region)) %>%
  drop_na() %>%
  mutate(
    hispanic = h_total*1000,
    nh_white_only = nh_white_only_ratio*1000,
    nh_black_only = nh_black_only_ratio*1000,
    nh_other = nh_other_ratio*1000
  ) %>%
  select(-(nh_white_only_ratio:h_total))

NY_finance_counties %>% 
  head(10) %>%
  knitr::kable(caption = "Chi-Square Test for Race and Counties", col.names = c("County", "Hispanic", "Non-Hispanic White", "Non-Hispanic Black", "Non-Hispanic Other"), align = c('l', 'c', 'c', 'c', 'c'), format = "simple")
```

Only the first 10 counties are printed.

```{r NY_chi-sq_finance_counties}
NY_finance_counties =
  NY_finance_counties %>%
  select(-borough)

# Run chi-square test
chisq.test(NY_finance_counties)
```

```{r NY_x_crit_finance_counties}
x_crit = qchisq(0.95, 135)
x_crit
```

From the above results, **$X^2$ is greater than the test-statistic at the 5% level of significance**. Therefore, **we reject the null hypothesis.** The data provides sufficient evidence to support the hypothesis that overall abortion rates in each finance category across counties is different.

### Chi Square Test - Age and NY State Counties

Due to missing data, a chi-squared analysis was not run for race and NY state regions.

**Do overall abortion rates differ across NY state counties by age?**

**$H_0$**: The expected abortion rates in each age category are the same across all NY state counties.

**$H_1$**: The expected abortion rates in each age category are not the same across all NY state counties.

```{r NY_tidy_age_counties}
# Tidy data
NY_age_clean = 
  merged %>%
  slice(-(1:2)) %>%
  select(-(nh_total:region)) %>%
  drop_na() %>%
  mutate(
    age_less_20 = age_less_20*1000,
    age_20_24 = age_20_24*1000,
    age_25_29 = age_25_29*1000,
    age_30_34 = age_30_34*1000,
    age_35_39 = age_35_39*1000,
    age_plus_40 = age_plus_40*1000
  )

NY_age_clean %>% 
  head(10) %>%
  knitr::kable(caption = "Chi-Square Test for Age and Counties", col.names = c("County", "< 20 years", "20-24 years", "25-29 years", "30-34 years", "35-39 years", "40+ years"), align = c('l', 'c', 'c', 'c', 'c', 'c', 'c'), format = "simple" )
```

Only the first 10 counties are printed.

```{r NY_chi-sq_age_counties}
NY_age_clean =
  NY_age_clean %>%
  select(-borough)

# Run chi-square test
chisq.test(NY_age_clean)
```

```{r NY_x_crit_age}
x_crit = qchisq(0.95, 275)
x_crit
```

From the above results, **$X^2$ is greater than the test-statistic at the 5% level of significance**. Therefore, **we reject the null hypothesis.** The data provides sufficient evidence to support the hypothesis that overall abortion rates in each age category across counties is different.

&nbsp; 

## Abortion Trends in NYC

&nbsp; 

### Proportion T-Test - Boroughs

**Do overall abortion rates differ across boroughs?**

**$H_0$**: The abortion rate per 1,000 live births is the same across all boroughs.

**$H_1$**: The abortion rate per 1,000 live births is not the same across all boroughs.

```{r tidy_borough}
# Tidy data
abortion_totals_borough =
  merged %>%
  select(borough, total) %>%
  slice(3:7) %>%
  mutate(
    n = total,
    total = 1000)

abortion_totals_borough %>%
  select (-total) %>%
  knitr::kable(caption = "Proportion T-Test for NYC across all Boroughs", col.names = c("Borough", "Abortion Rate per 1000 live births"), align = c('l', 'c'), format = "simple")
```

```{r prop_boroughs}
# Run 5 prop t-test
prop.test(abortion_totals_borough$n, abortion_totals_borough$total,
          p = NULL, alternative = "two.sided")
```

From the above results, the p-value is **less than the 5% level of significance**. Therefore, we **reject the null hypothesis**. The data provides sufficient evidence to support the hypothesis that overall abortion rates per 1000 births live differs across boroughs.

### Chi Square Test - Race and Boroughs

**Do overall abortion rates differ across boroughs by race?**

**$H_0$**: The expected abortion rate in each race category are the same across all boroughs.

**$H_1$**: The expected abortion rate in each race category are not the same across all boroughs.

```{r tidy_race}
# Tidy data
abortion_race_clean = 
  merged %>%
  slice(3:7) %>%
  select(-(age_less_20:nh_total)) %>% select(-(h_white_only_ratio:region)) %>%
  mutate(
    hispanic = h_total*1000,
    nh_white_only = nh_white_only_ratio*1000,
    nh_black_only = nh_black_only_ratio*1000,
    nh_other = nh_other_ratio*1000
  ) %>%
  select(-(nh_white_only_ratio:h_total))

abortion_race_clean %>% 
  knitr::kable(caption = "Chi-Square Test for Race and Boroughs", col.names = c("Borough", "Hispanic", "Non-Hispanic White", "Non-Hispanic Black", "Non-Hispanic Other"), align = c('l', 'c', 'c', 'c', 'c'), format = "simple")
```

```{r chi-sq_race}
abortion_race_clean =
  abortion_race_clean %>%
  select(-borough)

# Run chi-square test
chisq.test(abortion_race_clean)
```

```{r x_crit_race}
x_crit = qchisq(0.95, 12)
x_crit
```

From the above results, **$X^2$ is greater than the test-statistic at the 5% level of significance**. Therefore, we **reject the null hypothesis.** The data provides sufficient evidence to support the hypothesis that the abortion rate in each race category across boroughs is different. 

### Chi Square Test - Finance Plan and Boroughs

**Do overall abortion rates differ across boroughs by finance plan?**

**$H_0$**: The expected abortion rates in each finance plan category are the same across all boroughs.

**$H_1$**: The expected abortions rates in each finance plan category are not the same across all boroughs.

```{r tidy_finance}
# Tidy data
abortion_finance_clean = 
  merged %>%
  slice(3:7) %>%
  select(-(age_less_20:h_black_only_ratio)) %>%
  mutate(
    medicaid = medicaid*1000,
    self_pay = self_pay*1000,
    other_insurance = other_insurance*1000,
    not_stated = not_stated*1000
  ) %>%
  select(-(total:region))

abortion_finance_clean %>% 
  knitr::kable(caption = "Chi-Square Test for Finance Plan and Boroughs", col.names = c("Borough", "Medicaid", "Self-Pay", "Other Insurance", "Not Stated"), align = c('l', 'c', 'c', 'c', 'c'), format = "simple" )
```

```{r chi-squ_finance}
abortion_finance_clean =
  abortion_finance_clean %>%
  select(-borough)

# Run chi-square test
chisq.test(abortion_finance_clean)
```

```{r x_crit_finance}
x_crit = qchisq(0.95, 12)
x_crit
```

From the above results, **$X^2$ is greater than the test-statistic at the 5% level of significance**. Therefore, **we reject the null hypothesis.** The data provides sufficient evidence to support the hypothesis that the abortion rates in each finance category across borough is different.

### Chi Square Test - Age and Boroughs

**Do overall abortion rates differ across boroughs by age?**

**$H_0$**: The expected abortion rates in each age category are the same across all boroughs.

**$H_1$**: The expected abortion rates in each age category are not the same across all boroughs.

```{r tidy_age}
# Tidy data
abortion_age_clean = 
  merged %>%
  slice(3:7) %>%
  select(-(nh_total:region)) %>%
  mutate(
    age_less_20 = age_less_20*1000,
    age_20_24 = age_20_24*1000,
    age_25_29 = age_25_29*1000,
    age_30_34 = age_30_34*1000,
    age_35_39 = age_35_39*1000,
    age_plus_40 = age_plus_40*1000
  )

abortion_age_clean %>% 
  knitr::kable(caption = "Chi-Square Test for Age and Boroughs", col.names = c("Borough", "< 20 years", "20-24 years", "25-29 years", "30-34 years", "35-39 years", "40+ years"), align = c('l', 'c', 'c', 'c', 'c', 'c', 'c'), format = "simple" )
```

```{r chi-sq_age}
abortion_age_clean =
  abortion_age_clean %>%
  select(-borough)

# Run chi-square test
chisq.test(abortion_age_clean)
```

```{r x_crit_age}
x_crit = qchisq(0.95, 20)
x_crit
```

From the above results, **$X^2$ is greater than the test-statistic at the 5% level of significance**. Therefore, **we reject the null hypothesis.** The data provides sufficient evidence to support the hypothesis that the overall abortion rate in each age category across borough is different.

&nbsp; 

## Abortions Rates Comparing NYC and NY State

&nbsp; 

### Proportion T-test

**Do overall abortion rates differ between NYC and NY state?**

**$H_0$**: The abortion rate per 1,000 births is the same between NYC and NY state.

**$H_1$**: The abortion rate per 1,000 births differs between NYC and NY state.

```{r tidy_totals}
# Tidy data
abortion_totals =
  merged %>%
  select(borough, total) %>%
  head(2) %>%
  mutate(
    n = total,
    total = 1000)

abortion_totals %>% 
  select (-total) %>%
  knitr::kable(caption = "Proportion T-Test for NYC and NY State", col.names = c("Region", "Abortion Rate per 1000 births"), align = c('l', 'c'), format = "simple")
```

```{r prop}
# Run prop t-test
prop.test(abortion_totals$n, abortion_totals$total,
          p = NULL, alternative = "two.sided")
```

From the above results, the p-value is **less than the 5% level of significance.** Therefore, we **reject the null hypothesis.** The data provides sufficient evidence to support the hypothesis that the abortion rate per 1000 births differs between NYC and NY state.

&nbsp; 

# Limitations 
***

There were a couple of limitations in our project including the amount of limited abortion data in some of the counties. For the race dataset specifically, some of the data was noted as suppressed due to confidentiality. As a result, we had to omit Eastern and Western Adirondacks from our statistical analysis, despite the possibility that there might be valuable information in these regions. Similarly, for the financial plan dataset, there were some finance plans that had very small cell counts. The plans with small cell counts were eventually omitted as they were not included in the live birth data set, the denominator to calculate abortion rates. As a result, the statistical analysis for financial plan may not show the full scale of the differences between the plans. 

# Discussion
***

Based on our statistical analysis, we found that abortion rates in 2019 are significantly different across New York City boroughs, New York state regions, and New York state counties. Abortion rates in 2019 are also significantly different across the aforementioned geographical units adjusting for the covariates of interest: race, financial plan, and age. In addition, abortion rates in 2019 are significantly different between New York City and New York state. These results are what we expected due to the history of reproductive rights and existing socioeconomic disparities in the United States. More specifically, people of color, people with higher financial burdens, and people who are younger are most impacted by the state of abortion access. In New York City, where there have been policies put into place to promote reproductive rights, there are still disparities in abortion access due to deeply rooted systems of oppression. From our exploratory analysis, we found that the highest abortion rate is found among those in the Bronx among those who are Non-Hispanic Black. With respect to insurance plans, the lowest abortion rate is found among those with Medicaid, which is an insurance plan used by those with a low income. With respect to age, the highest abortion rate is found among those who are younger than 20 years of age.

These insights are useful for state and local governments to determine where and to whom to allocate more social services and resources to promote reproductive health. Future analyses can focus on exploring the trends and distribution of abortion rates in New York City and New York State on a neighborhood level, mapping the locations of abortion clinics and other sexual and reproductive services, and repeating these exploratory and statistical analyses as data for recent years are released.

&nbsp; 

# Additional Resources/ Related Work
***

From a public health stand point, reproductive rights are basic human rights, and women should be allowed to have full autonomy on decisions regarding their bodies. The issue at hand, however, is very complicated and nuanced, with opposing views and beliefs.

Regardless of the stance people take on abortions, studies and past data has found that reproductive justice is inextricably bound to discrimination and inequality. As residents of New York City, we wanted to analyze the trends in abortion, and how it might be affected by factors such as race/ethnicity, financial plan status and age to better understand differences in trends. 

Here is some recent information on abortion clinics/ laws/ and facts:

- In New York City, call the NYC Abortion Access Hub at [1-877-NYC-AHUB](tel:18776922482) or [1-877-692-2482](tel:18776922482)

- [AbortionFinder.org](https://www.abortionfinder.org/)

- [Planned Parenthood](https://www.plannedparenthood.org/abortion-access)

- [after Roe Fell: Abortion Laws by State](https://reproductiverights.org/maps/abortion-laws-by-state/)

- [Guttmacher Institute](https://www.guttmacher.org/state-policy/explore/overview-abortion-laws)

- [What's Next for Abortion Rights in New York?](https://www.nytimes.com/2022/07/08/nyregion/abortion-new-york-roe.html)

- [National Network of Abortion Funds](https://abortionfunds.org/) 

- [Abortion Reporting: New York City (2019)](https://lozierinstitute.org/abortion-reporting-new-york-city-2019/)

<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;"></div> 
