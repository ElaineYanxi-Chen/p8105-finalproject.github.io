---
title: " Project Report"
output: 
  html_document: 
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: true
---

```{r setup, message = FALSE, echo = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(ggridges)
library(patchwork)
library(plotly)

knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

```{r merged data, message = FALSE, echo = FALSE}
merged = read_csv("data/master.csv") %>% 
  janitor::clean_names()
```

# Motivation


In 2019, many conservative states raced to enact an unprecedented wave on bans on abortions that have severely restricted women’s reproductive rights. These restrictions have culminated with the recent Supreme Court overturning of Roe v. Wade, a landmark supreme court case granting a women’s right to an abortion. 

<img src="images/2019_abortion.jpg" style = "width:70%">

Source: [Guttmacher Institute](https://www.guttmacher.org/article/2019/12/state-policy-trends-2019-wave-abortion-bans-some-states-are-fighting-back)

Since then, access to abortion has been significantly compromised and even banned in several states across the country. Those that are likely to be most impacted by this decision are individuals that belong to under-served and marginalized communities. Changes in policies could potentially lead to a variation in abortion trends in the country over time. We want to explore these trends to understand the implications of the policy change in the country concerning reproductive rights. 

Our year of interest is 2019, which is the most recent dataset provided by New York State. We will be focusing on the number of induced abortions per 1,000 live birth in New York City and New York State and compare the differences across the boroughs (for New York City) and counties (for New York State). Several variables that we are considering are age, race/ethnicity, and financial plans. We are also interested on how the total rate of abortion changes over years from 2014 to 2019. 

# Additional Resources/ Related Work

Reproductive rights are basic human rights, and women should be allowed to have full autonomy on decisions regarding their bodies. They should be allowed to exercise their rights and make decisions freely and responsibly. Reproductive justice goes far beyond the right to abortion; the issue is inextricably bound to discrimination and inequality. As residents of New York City, we wanted to analyze the trends in abortion, and how it might be affected by factors such as race/ethnicity, financial plan status and age. 

Here's some recent information on abortion clinics/ laws/ and facts:

- In New York City, call the NYC Abortion Access Hub at [1-877-NYC-AHUB](tel:18776922482) or [1-877-692-2482](tel:18776922482)

- [AbortionFinder.org](https://www.abortionfinder.org/)

- [Planned Parenthood](https://www.plannedparenthood.org/abortion-access)

- [after Roe Fell: Abortion Laws by State](https://reproductiverights.org/maps/abortion-laws-by-state/)

- [Guttmacher Institute](https://www.guttmacher.org/state-policy/explore/overview-abortion-laws)

- [What's Next for Abortion Rights in New York?](https://www.nytimes.com/2022/07/08/nyregion/abortion-new-york-roe.html)

- [National Network of Abortion Funds](https://abortionfunds.org/) 

- [Abortion Reporting: New York City (2019)](https://lozierinstitute.org/abortion-reporting-new-york-city-2019/)

# Initial questions

Originally, we wanted to conduct a comparative analysis of abortion rates in New York and Mississippi from 2017-2020 with the following questions:

* Have abortion rates changed over time (2017 to 2020) in New York and Mississippi?
* What does the distribution of abortion rates between counties within New York and Mississippi look like?
* Are abortion rates different in New York compared to Mississippi while accounting for age, race/ethnicity, method, and insurance plan?

We were unable to find a comprehensive dataset that included individual level data needed to answer these questions. Therefore, decided to focus on conducting an analysis of rates of abortion between boroughs in New York City in 2019. Our research questions thus changed as follows:

## Final Research Questions:

* What does the distribution of rates of abortion between boroughs within New York City look like in 2019?
  * Are abortion rates different among boroughs in New York City while accounting for age, race/ethnicity, and finance plans in 2019?
* How do abortion rates differ between New York City and New York State in 2019?
* How do abortion rates differ within regions/counties of New York State in 2019?
  * Are abortion rates different among regions/counties of New York State while accounting for age, race/ethnicity, and finance plans?

# Data

## Source

For this project, we will use data from [Vital Statistics of New York State 2014-2019](https://www.health.ny.gov/statistics/vital_statistics/) which consists of group-level data from New York City and New York State for age, race/ethnicity, and finance plans, each being its own data set. 

- The data were collected from the New York State Bureau of Vital Records who maintains a registry of all births, marriages, divorces/dissolutions of marriage, deaths, induced termination of pregnancy/abortions, and fetal deaths that have occurred in New York State. 

- The [New York City Department of Health and Mental Hygiene](https://www.health.ny.gov/health_care/medicaid/redesign/ehr/registry/nycdohmh.htm) sends data on on live births, deaths, fetal deaths, induced terminations of pregnancy/abortions (abortion), marriages, and divorces/dissolutions of marriage recorded in New York City to the New York State Department of Health. 

- The New York State Department of Health receives data on live births and deaths recorded outside of New York State to residents of New York State from other states and Canada.

- The two regions are categorized as follows:

  - New York City includes five counties: Bronx, Kings (Brooklyn), New York (Manhattan), Queens, and Richmond (Staten Island). 

  - New York State encompasses all 62 counties, including five from New York City.

From the Vital Statistics of New York State 2019, we will use data from the *Induced Abortions* and *Live Births* section in order to find information on finance plans. 

## Data Scraping and Cleaning 

We first imported the data sets representing rates of abortion from the Vital Statistics of New York State 2019 webpage. We cleaned and merged the data appropriately to create a final master spreadsheet, which we will be pulling from for each of our analyses.

For the finance plans data set, we imported the number of induced abortion and number of live births in order to calculate the rates of abortion manually. The equation we used is as follow:

$$Abortion\ Rate\ per\ 1000\ Live\ Births\ = \frac{Count}{Number\ of\ Live\ Births} \times 1000$$
We renamed variable names for the different counties in New York City to the name of the boroughs. Final variable names in our dataset for the New York City include:

- `Manhattan`
- `Bronx`
- `Brooklyn`
- `Queens`
- `Staten Island` 

From the same dataset, there are 62 counties in New York State, being:
`r merged %>% pull(borough) %>% rownames()`

Data on New York State were obtained from the same dataset, and counties were recoded into regions based on categories set by New York State using `transform`. Some counties had very few abortion numbers, which would not provide a sufficient sample size when stratifying based on covariates. As a result, the categorizing the regions will ensure a sufficient sample size. 

The final regions included in the dataset for New York State includes:

- `Central New York`
- `Eastern Adirondacks`
- `Western Adirondacks`
- `Saratoga`
- `Finger Lakes`
- `Western New York`
- `Hudson Valley`
- `Westchester/Rockland`
- `Long Island`
- `New York City`

The regions were created based on this [website](https://statejobs.ny.gov/assets/help/regionMapText.cfm)

Specific data cleaning processes for the covariates are listed below.

#### Age

Age was categorized as follows:

- `age_less_20`
- `age_20_24`
- `age_25_29`
- `age_30_34`
- `age_35_39`
- `age_plus_40`

#### Race/Ethnicity

Race/Ethnicity was broken down into the following categories:

- `Non-Hispanic White`
- `Non-Hispanic Black` 
- `Non-Hispanic Others` 
- `Hispanic`

Ethnicity is distinguished from race and is based on the ethnicity of the mother. Ethnicity distinguishes individuals of Spanish origin regardless of race. Race was self-reported. 
 
#### Financial Plan Status

The final variable names include:

- `Medicaid`
- `Other_insurance`
- `self_pay`
- `not stated`

The technical notes in the dataset did not specify which plans were included under the `other_insurance` category. 

After individual datasets were tidied, they were merged into a final dataset which was then saved and exported to our project repository. These steps were necessary to ensure that the code was readable and reproducible. 

### Final Dataset

Here is what our final, cleaned and tidied dataset looks like: 

```{r}
final= 
  merged %>%
  select(borough, region, total, everything()) %>%
  mutate_if(is.numeric,
            round,
            digits = 1)

final_table= 
  kableExtra::kable(cbind(final), align = 'llcccccccccccccccc', col.names = c("Borough", "Region", "Total","<20","20-24","25-29","30-34","35-39","40+", "Non-Hipanic Total", "Non-Hispanic White", "Non-Hispanic Black", "Non-Hispanic Other", "Hispanic Total", "Hispanic White", "Hispanic Black", "Medicaid", "Self-Pay", "Other Insurance", "Not Stated")) %>%
  kableExtra::kable_styling() %>%
  kableExtra::scroll_box(width = "800px", height = "400px")

final_table
```


# Exploratory analysis

Our exploratory analysis was split into two categories - [New York State](ny_exploratory_analysis.html) and [New York City](nyc_exploratory_analysis.html). We analyzed how abortion rates may have different across different categories of our covariates (Age, Race/Ethnicity and Financial Plan Status), using plots created via `plotly`. In this report, all plots seen here have been made using `ggplot`. For interactive plots, head over to the individual exploratory analyses pages linked above! 

## NYC Analysis Results:


#### Age:

```{r}
age_nyc = 
  merged %>%
  select(1:7) %>%
  slice(3:7)

age_nyc %>%
  pivot_longer(
    age_less_20:age_plus_40,
    names_to = "age", 
    values_to = "abortion",
    names_prefix = "age_"
  ) %>%
  mutate(
    age = replace(age, age == "less_20", "<20"),
    age = replace(age, age == "20_24", "20-24"),
    age = replace(age, age == "25_29", "25-29"),
    age = replace(age, age == "30_34", "30-34"),
    age = replace(age, age == "35_39", "35-39"),
    age = replace(age, age == "plus_40", "40+"),
    age = factor(age)
  ) %>%
  ggplot(aes(x = age, y = abortion, fill= borough, color= borough)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NYC by Age",
    x = "Age (Years)",
    y = "Abortions per 1,000 Live Births"
    )
```


From the bar plots, it is evident that those who age less than 20 have the highest abortion ratios across the boroughs in NYC in 2019. These ratios eem to decrease as age categories increase. When comparing between boroughs, Manhattan had the highest abortion ratios in categories `<20` and `25-29`. Staten Island had the lowest abortion ratios overall, except for category `20-24`. The highest abortion rate across all boroughs and age categories was for Manhattan for `< 20` with 1964.9 induced abortions per 1,000 live births. The lowest abortion ratio across all boroughs and age categories was in Staten Island for `35-39` with 130 induced abortions per 1,000 live births. 

#### Race/Ethnicity:

```{r}
race_nyc = 
  merged %>%
  select(1,9:12) %>%
  slice(3:7)

race_nyc %>%
  pivot_longer(
    nh_white_only_ratio:h_total,
    names_to = "race", 
    values_to = "abortion"
  ) %>%
    mutate(
    race = replace(race, race == "nh_white_only_ratio", "Non-Hispanic White Only"),
    race = replace(race, race == "nh_black_only_ratio", "Non-Hispanic Black Only"),
    race = replace(race, race == "nh_other_ratio", "Non-Hispanic Other"),
    race = replace(race, race == "h_total", "Hispanic"),
    race = factor(race)
    ) %>%
  ggplot(aes(x = race, y = abortion, fill= borough, color= borough)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NYC by Race/Ethnicity",
    x = "Race/Ethnicity",
    y = "Abortions per 1,000 Live Births"
    )
```

From the bar plots, it is evident that those who identified as Non-Hispanic Black Only had the highest abortion ratios across all boroughs in NYC. Among those who identified as Non-Hispanic Black Only, rates were highest in Manhattan with 1,228.3 induced abortions per 1,000 live births. Those who identified as Non-Hispanic White and Non-Hispanic Other had some of the lowest abortion ratios in NYC. The lowest rates across all boroughs and race groups was for those who identified as Non-Hispanic White only and lived in Brooklyn with a rates of 88.6 induced abortions per 1,000 live births. 

#### Financial Plan Status:

```{r}
finance_plan_nyc= 
  merged %>%
  select(1,15:18) %>%
  slice(3:7)

finance_plan_nyc %>%  
  pivot_longer(
    medicaid:not_stated,
    names_to = "finance_plan", 
    values_to = "abortion"
  ) %>%
 mutate(
    finance_plan = replace(finance_plan, finance_plan == "medicaid", "Medicaid"),
    finance_plan = replace(finance_plan, finance_plan == "self_pay", "Self Pay"),
    finance_plan = replace(finance_plan, finance_plan == "other_insurance", "Other Insurance"),
    finance_plan = replace(finance_plan, finance_plan == "not_stated", "Not Stated"),
    finance_plan = factor(finance_plan)
    )%>%
  ggplot(aes(x = finance_plan, y = abortion, fill= borough, color= borough)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NYC by Financial Plan",
    x = "Financial Plan Status",
    y = "Abortions per 1,000 Live Births"
    )
```

From the bar plots, those who were categorized as having Other Insurance had the highest abortion rates across all financial plans in NYC with a rate of 62.86k induced abortions per 1000 live births. When calculating abortion rates for financial plans, we manually calculated these rates from (induced abortions/ live births)*1000 as they were not provided like in other data sets. A huge flaw in these numbers is that those who have induced abortions and those who give births tend to use different insurance plans. People who give birth are unlikely to use `Other Insurance` in comparison to those who have induced abortions due to the inherent differences in procedures. Those who used Self Pay for induced abortions had a relatively high abortion rates as well. This would make sense as well given the nature of the procedure and possible restrictions by the health insurance plan to cover abortions. Medicaid had the lowest abortion rates across all financial plans, and the rates were lowest with 287 induced abortions per 1000 live births.

## NY State Analysis Results 

#### Age 

```{r}
age_nys = 
  merged %>%
  select(region, starts_with("age")) %>% 
  pivot_longer(
    age_less_20:age_plus_40,
    names_to = "age", 
    values_to = "abortion",
    names_prefix = "age_"
  ) %>% 
  mutate(
    age = replace(age, age == "less_20", "<20"),
    age = replace(age, age == "20_24", "20-24"),
    age = replace(age, age == "25_29", "25-29"),
    age = replace(age, age == "30_34", "30-34"),
    age = replace(age, age == "35_39", "35-39"),
    age = replace(age, age == "plus_40", "40+"),
    age = factor(age)
  ) %>%
  group_by(region,age)%>%
  summarise(total = sum(abortion)) %>% 
  ggplot(aes(x = age, y = total, fill= region, color= region)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NY State by Age",
    x = "Age (Years)",
    y = "Abortions per 1,000 Live Births"
    )

age_nys  
```

From the above plot, it is evident that within different categories of age, the highest abortion rate per 1000 live births is among those that are below 20 years of age. We see a decline in induced abortion rates among older people across all regions within New York State. The highest abortion rate is found among those in New York City who are <20 years with 7677.5 induces abortions per 1000 live births. While New York city has higher abortion rates across most age categories, we see that among those that are 35+, higher rates of abortion are found among those in the Finger Lakes, Capital/Saratoga, and Central New York regions.

#### Race/Ethnicity

```{r}
race_nys = 
  merged %>%
  select(region, nh_white_only_ratio:h_total) %>%
  pivot_longer(
    nh_white_only_ratio:h_total,
    names_to = "race", 
    values_to = "abortion"
    ) %>%
  mutate(
    race = replace(race, race == "nh_white_only_ratio", "Non-Hispanic White Only"),
    race = replace(race, race == "nh_black_only_ratio", "Non-Hispanic Black Only"),
    race = replace(race, race == "nh_other_ratio", "Non-Hispanic Other"),
    race = replace(race, race == "h_total", "Hispanic"),
    race = factor(race)
    ) %>%
  group_by(region,race)%>%
  summarise(total = sum(abortion)) %>% 
  ggplot(aes(x = race, y = total, fill= region, color= region)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NY State by Race/Ethnicity",
    x = "Race/Ethnicity",
    y = "Abortions per 1,000 Live Births"
    )

race_nys 
```

When looking at abortion rates within different race/ethnicity categories, we observe that the highest rates of abortion are among those who identify as Non-Hispanic Black. The highest rate of abortion is among those residing in New York City and identify as Non-Hispanic Black with 4638.1 induced abortions per 1000 live births. Hispanic individuals also seem to have high rates of abortion, and the highest rate of abortion within this category is among those that reside in the Capital/ Saratoga region (3698.2 per 1000 live births). 


#### Financial Plan Status

```{r}
finance_nys = 
  merged %>%
  select(region, medicaid:not_stated) %>%
  pivot_longer(
    medicaid:not_stated,
    names_to = "finance_plan", 
    values_to = "abortion"
  ) %>% 
  mutate(
    finance_plan = replace(finance_plan, finance_plan == "medicaid", "Medicaid"),
    finance_plan = replace(finance_plan, finance_plan == "self_pay", "Self Pay"),
    finance_plan = replace(finance_plan, finance_plan == "other_insurance", "Other Insurance"),
    finance_plan = replace(finance_plan, finance_plan == "not_stated", "Not Stated"),
    finance_plan = factor(finance_plan)
    ) %>%
  group_by(region,finance_plan)%>%
  summarise(total = sum(abortion)) %>% 
  ggplot(aes(x = finance_plan, y = total, fill= region, color= region)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NY State by Financial Plan Status",
    x = "Financial Plan",
    y = "Abortions per 1,000 Live Births"
    )

```

Highest rates of abortion are found among those enrolled in the `Not Stated` insurance category, followed by the `Other Insurance` category. The highest rate of abortion, when stratified by insurance enrollment, is found among those residing in the Capital/Saratoga region, and reporting as `Not Stated` insurance category with 168.1k induced abortions per 1000 live births. Within New York City, highest rates are found among those that are enrolled in `Other Category` insurance plans with a rate of 150.1k induced abortions per 1000 live births. Lowest rates of abortion are found among those that are enrolled in Medicaid. 

## Comparing NYC and NY State

#### NY vs NYC Age

```{r}
age_total = 
  merged %>%
  select(1:7) %>%
  slice(1:2)

age_total %>%
  pivot_longer(
    age_less_20:age_plus_40,
    names_to = "age", 
    names_prefix = "age_",
    values_to = "abortion"
  ) %>% 
  mutate(
    age = replace(age, age == "less_20", "<20"),
    age = replace(age, age == "20_24", "20-24"),
    age = replace(age, age == "25_29", "25-29"),
    age = replace(age, age == "30_34", "30-34"),
    age = replace(age, age == "35_39", "35-39"),
    age = replace(age, age == "plus_40", "40+"),
    age = factor(age)
  ) %>% 
  ggplot(aes(x = age, y = abortion, fill= borough, color= borough)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NYC Vs. NYS by Age",
    x = "Age (Years)",
    y = "Abortions per 1,000 Live Births"
    )

```

From the bar plots, it is evident that those in New York City have higher abortion rates compared to those in New York State across all age categories. Rates seem to decrease as age categories increase for New York City; however, for New York State, rates decrease from the <20 to 35-39 age categories, and increase among those who are 40+. Rates were highest among those who were <20 years for both New York City and New York State. Those <20 years in New York State had the highest rates across all categories of 1491.4 abortions per 1000 live births.

#### NY vs. NYC Race

```{r}
race_total = 
  merged %>%
  select(1,9:12) %>%
  slice(1:2)

race_total %>%
  pivot_longer(
    nh_white_only_ratio:h_total,
    names_to = "race", 
    values_to = "abortion"
  ) %>%
  mutate(
    race = replace(race, race == "nh_white_only_ratio", "Non-Hispanic White Only"),
    race = replace(race, race == "nh_black_only_ratio", "Non-Hispanic Black Only"),
    race = replace(race, race == "nh_other_ratio", "Non-Hispanic Other"),
    race = replace(race, race == "h_total", "Hispanic"),
    race = factor(race)
    )%>% 
  ggplot(aes(x = race, y = abortion, fill= borough, color= borough)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NYC vs. NYS by Race/Ethnicity",
    x = "Race/Ethnicity",
    y = "Abortions per 1,000 Live Births"
    )

```

It is evident that those who identified as Non-Hispanic Black Only had the highest abortion rates across all boroughs in NYC. Among those who identified as Non_Hispanic_Black, rates were highest in Manhattan with 851.7 induced abortions per 1,000 live births. Those who identified as Non-Hispanic White and Non-Hispanic Other had some of the lowest abortion rates in NYC. The lowest rates across all boroughs and race groups was for those who identified as Non-Hispanic White only and lived in Brooklyn with a rates of 142.9 induced abortions per 1,000 live births. 

#### NY vs. NYC Financial Plans

```{r}
finance_plan_total= 
  merged %>%
  select(1,15:18) %>%
  slice(1:2)

finance_plan_total %>%  
  pivot_longer(
    medicaid:not_stated,
    names_to = "finance_plan", 
    values_to = "abortion"
  ) %>%
  mutate(
    finance_plan = replace(finance_plan, finance_plan == "medicaid", "Medicaid"),
    finance_plan = replace(finance_plan, finance_plan == "self_pay", "Self Pay"),
    finance_plan = replace(finance_plan, finance_plan == "other_insurance", "Other Insurance"),
    finance_plan = replace(finance_plan, finance_plan == "not_stated", "Not Stated"),
    finance_plan = factor(finance_plan)
    ) %>% 
  ggplot(aes(x = finance_plan, y = abortion, fill= borough, color= borough)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NYC vs. NYS by Financial Plan",
    x = "Financial Plan Status",
    y = "Abortions per 1,000 Live Births"
    )
```

Rates were highest for those with Other Insurance in both New York City and New York State and was higher in New York City with 19.92k induced abortions per 1000 live births. Rates were lowest for those with Medicaid in both New York City and New York State and was lower for those in New York State with 325.66 induced abortions per 1000 live births. 

# Statistical Analysis


If you undertake formal statistical analyses, describe these in detail

# Limiations 

There were a couple of limitations in our project including the amount of limited abortion data in some of the counties. For the race dataset specifically, some of the data was noted as suppressed due to confidentiality. As a result, we had to omit Eastern and Western Adirondacks from our statistical analysis, despite the possibility that there might be valuable information in these regions. Similarly, for the financial plan dataset, there were some plans that had very small cell counts. The plans with small cell counts were eventually omitted as they were not included in the live birth data set, the denominator to calculate abortion rates. As a result, the statistical analysis for financial plan may not show the full scale of the differences between the plans. 

# Discussion


What were your findings? Are they what you expect? What insights into the data can you make?
