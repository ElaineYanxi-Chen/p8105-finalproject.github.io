---
title: " Project Report"
output: 
  html_document: 
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: true
---

```{r setup, message = FALSE, echo = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(ggridges)
library(patchwork)
library(plotly)

knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

```{r merged data, message = FALSE, echo = FALSE}
merged = read_csv("data/master.csv") %>% 
  janitor::clean_names()
```

# Motivation


In 2019, many conservative states raced to enact an unprecedented wave on bans on abortions that have severely restricted women’s reproductive rights. These restrictions have culminated with the recent Supreme Court overturning of Roe v. Wade, a landmark supreme court case granting a women’s right to an abortion. 

<img src="images/2019_abortion.jpg" style = "width:70%">

Source: [Guttmacher Institute](https://www.guttmacher.org/article/2019/12/state-policy-trends-2019-wave-abortion-bans-some-states-are-fighting-back)

Since then, access to abortion has been significantly compromised and even banned in several states across the country. Those that are likely to be most impacted by this decision are individuals that belong to under-served and marginalized communities. Changes in policies could potentially lead to a variation in abortion trends in the country over time. We want to explore these trends to understand the implications of the policy change in the country concerning reproductive rights. 

Our year of interest is 2019, which is the most recent dataset provided by New York State. We will be focusing on the number of induced abortions per 1,000 live birth in New York City and New York State and compare the differences across the boroughs (for New York City) and counties (for New York State). Several variables that we are considering are age, race/ethnicity, and financial plans. We are also interested on how the total rate of abortion changes over years from 2014 to 2019. 

# Additional Resources/ Related Work

Reproductive rights are basic human rights, and women should be allowed to have full autonomy on decisions regarding their bodies. They should be allowed to exercise their rights and make decisions freely and responsibly. Reproductive justice goes far beyond the right to abortion; the issue is inextricably bound to discrimination and inequality. As residents of New York City, we wanted to analyze the trends in abortion, and how it might be affected by factors such as race/ethnicity, financial plan status and age. 

Here's some recent information on abortion clinics/ laws/ and facts:

- In New York City, call the NYC Abortion Access Hub at [1-877-NYC-AHUB](tel:18776922482) or [1-877-692-2482](tel:18776922482)

- [AbortionFinder.org](https://www.abortionfinder.org/)

- [Planned Parenthood](https://www.plannedparenthood.org/abortion-access)

- [after Roe Fell: Abortion Laws by State](https://reproductiverights.org/maps/abortion-laws-by-state/)

- [Guttmacher Institute](https://www.guttmacher.org/state-policy/explore/overview-abortion-laws)

- [What's Next for Abortion Rights in New York?](https://www.nytimes.com/2022/07/08/nyregion/abortion-new-york-roe.html)

- [National Network of Abortion Funds](https://abortionfunds.org/) 

- [Abortion Reporting: New York City (2019)](https://lozierinstitute.org/abortion-reporting-new-york-city-2019/)

# Initial questions

Originally, we wanted to conduct a comparative analysis of abortion rates in New York and Mississippi from 2017-2020 with the following questions:

* Have abortion rates changed over time (2017 to 2020) in New York and Mississippi?
* What does the distribution of abortion rates between counties within New York and Mississippi look like?
* Are abortion rates different in New York compared to Mississippi while accounting for age, race/ethnicity, method, and insurance plan?

We were unable to find a comprehensive dataset that included individual level data needed to answer these questions. Therefore, decided to focus on conducting an analysis of rates of abortion between boroughs in New York City in 2019. Our research questions thus changed as follows:

## Final Research Questions:

* What does the distribution of rates of abortion between boroughs within New York City look like in 2019?
  * Are abortion rates different among boroughs in New York City while accounting for age, race/ethnicity, and finance plans in 2019?
* How do abortion rates differ between New York City and New York State in 2019?
* How do abortion rates differ within regions/counties of New York State in 2019?
  * Are abortion rates different among regions/counties of New York State while accounting for age, race/ethnicity, and finance plans?

# Data

## Source

For this project, we will use data from [Vital Statistics of New York State 2014-2019](https://www.health.ny.gov/statistics/vital_statistics/) which consists of group-level data from New York City and New York State for age, race/ethnicity, and finance plans, each being its own data set. 

- The data were collected from the New York State Bureau of Vital Records who maintains a registry of all births, marriages, divorces/dissolutions of marriage, deaths, induced termination of pregnancy/abortions, and fetal deaths that have occurred in New York State. 

- The [New York City Department of Health and Mental Hygiene](https://www.health.ny.gov/health_care/medicaid/redesign/ehr/registry/nycdohmh.htm) sends data on on live births, deaths, fetal deaths, induced terminations of pregnancy/abortions (abortion), marriages, and divorces/dissolutions of marriage recorded in New York City to the New York State Department of Health. 

- The New York State Department of Health receives data on live births and deaths recorded outside of New York State to residents of New York State from other states and Canada.

- The two regions are categorized as follows:

  - New York City includes five counties: Bronx, Kings (Brooklyn), New York (Manhattan), Queens, and Richmond (Staten Island). 

  - New York State encompasses all 62 counties, including five from New York City.

From the Vital Statistics of New York State 2019, we will use data from the *Induced Abortions* and *Live Births* section in order to find information on finance plans. 

## Data Scraping and Cleaning 

We first imported the data sets representing rates of abortion from the Vital Statistics of New York State 2019 webpage. We cleaned and merged the data appropriately to create a final master spreadsheet, which we will be pulling from for each of our analyses.

For the finance plans data set, we imported the number of induced abortion and number of live births in order to calculate the rates of abortion manually. The equation we used is as follow:

$$Abortion\ Rate\ per\ 1000\ Live\ Births\ = \frac{Count}{Number\ of\ Live\ Births} \times 1000$$
We renamed variable names for the different counties in New York City to the name of the boroughs. Final variable names in our dataset for the New York City include:

- `Manhattan`
- `Bronx`
- `Brooklyn`
- `Queens`
- `Staten Island` 

From the same dataset, there are 62 counties in New York State, being:
`r master %>% pull(borough) %>% rownames()`

Data on New York State were obtained from the same dataset, and counties were recoded into regions based on categories set by New York State using `transform`. Some counties had very few abortion numbers, which would not provide a sufficient sample size when stratifying based on covariates. As a result, the categorizing the regions will ensure a sufficient sample size. 

The final regions included in the dataset for New York State includes:

- `Central New York`
- `Eastern Adirondacks`
- `Western Adirondacks`
- `Saratoga`
- `Finger Lakes`
- `Western New York`
- `Hudson Valley`
- `Westchester/Rockland`
- `Long Island`
- `New York City`

The regions were created based on this [website](https://statejobs.ny.gov/assets/help/regionMapText.cfm)

Specific data cleaning processes for the covariates are listed below.

#### Age

Age was categorized as follows:

- `age_less_20`
- `age_20_24`
- `age_25_29`
- `age_30_34`
- `age_35_39`
- `age_plus_40`

#### Race/Ethnicity

Race/Ethnicity was broken down into the following categories:

- `Non-Hispanic White`
- `Non-Hispanic Black` 
- `Non-Hispanic Others` 
- `Hispanic`

Ethnicity is distinguished from race and is based on the ethnicity of the mother. Ethnicity distinguishes individuals of Spanish origin regardless of race. Race was self-reported. 
 
#### Financial Plan Status

The final variable names include:

- `Medicaid`
- `Other_insurance`
- `self_pay`
- `not stated`

The technical notes in the dataset did not specify which plans were included under the `other_insurance` category. 

After individual datasets were tidied, they were merged into a final dataset which was then saved and exported to our project repository. These steps were necessary to ensure that the code was readable and reproducible. 

### Final Dataset

Here is what our final, cleaned and tidied dataset looks like: 

```{r}
final= 
  merged %>%
  select(borough, region, total, everything()) %>%
  mutate_if(is.numeric,
            round,
            digits = 1)

final_table= 
  kableExtra::kable(cbind(final), align = 'llcccccccccccccccc', col.names = c("Borough", "Region", "Total","<20","20-24","25-29","30-34","35-39","40+", "Non-Hipanic Total", "Non-Hispanic White", "Non-Hispanic Black", "Non-Hispanic Other", "Hispanic Total", "Hispanic White", "Hispanic Black", "Medicaid", "Self-Pay", "Other Insurance", "Not Stated")) %>%
  kableExtra::kable_styling() %>%
  kableExtra::scroll_box(width = "800px", height = "400px")

final_table
```


# Exploratory analysis

Our exploratory analysis was split into two categories - [New York State](ny_exploratory_analysis.html) and [New York City](nyc_exploratory_analysis.html). We analyzed how abortion rates may have different across different categories of our covariates (Age, Race/Ethnicity and Financial Plan Status), using plots created via `plotly`. In this report, all plots seen here have been made using `ggplot`. For interactive plots, head over to the individual exploratory analyses pages linked above! 

## NYC Analysis Results:


#### Age:


- The highest rates was found in Manhattan among those who are less than 20 years old with a rate of 1964.9 induced abortions per 1000 live births. 

- The second highest rate is was found among those less than 20 year old in Queens with a rate of 1780.1 induced abortions per 1000 live births. 

- **Overall, the rate of abortions seem to decrease with age. Across the age categories, it appears that Staten Island, New York State, and Brooklyn seemed to have lower abortion rates. **

#### Financial Plan Status:

- The highest rates were found in Manhattan among those with "Other insurance" with a rate of 62.86k induced abortions per 1000 live births. 

- **The rates were highest among those with "Other insurance" and second highest among those with "self_pay." Rates were lowest among those with Medicaid. **

#### Race/Ethnicity:

- Non-Hispanic Individuals: 

  - The highest rates were found in the Bronx among those who identify as Non-Hispanic-Black Only with a rate of 1228.3 induced abortions per 1000 live births. 
  - The lowest rate was found among Non-Hispanic White Only individuals in Brooklyn with a rate of 88.6 induced abortions per 1000 live births. 
  - **The rates were highest among those who were Non-Hispanic-Black Only.** 

- Hispanic Individuals: 

  - The highest rates were found in the Bronx among those who are Hispanic-Black Only with a rate of 684.6 induced abortions per 1000 live births. 
  - The lowest rate was found among Hispanic White-Only in Queens with a rate of 80.4 induced abortions per 1000 live births. 
  - **The rates were generally higher among those who were Hispanic-Black Only in comparison to those who were Hispanic White-Only. **

#### Year:

- From the plot, it is evident that **rates are generally decreasing from 2014-2019.** 

It is important to note that Staten Island had a noticeable increase and decrease of rates in 2016. This is likely due to an external factor, like a policy change. However, Staten Island had the lowest rates for most years in relation to the other boroughs overall. Bronx had the highest rates between 2014-2019. 

## NY State Analysis Results 

#### Age 

```{r}
age_nys = 
  merged %>%
  select(region, starts_with("age")) %>% 
  pivot_longer(
    age_less_20:age_plus_40,
    names_to = "age", 
    values_to = "abortion",
    names_prefix = "age_"
  ) %>% 
  mutate(
    age = replace(age, age == "less_20", "<20"),
    age = replace(age, age == "20_24", "20-24"),
    age = replace(age, age == "25_29", "25-29"),
    age = replace(age, age == "30_34", "30-34"),
    age = replace(age, age == "35_39", "35-39"),
    age = replace(age, age == "plus_40", "40+"),
    age = factor(age)
  ) %>%
  group_by(region,age)%>%
  summarise(total = sum(abortion)) %>% 
  ggplot(aes(x = age, y = total, fill= region, color= region)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NY State by Age",
    x = "Age (Years)",
    y = "Abortions per 1,000 Live Births"
    )

age_nys  
```

- From the above plot, it is evident that within different categories of age, the highest abortion rate per 1000 live births is among those that are below 20 years of age. 

- We see a decline in induced abortion rates among older people across all regions within New York State. 

- The highest abortion rate is found among those in New York City who are <20 years (7677.5 per 1000 live births). 

- While New York city has higher abortion rates across most age categories, we see that among those that are 35+, higher rates of abortion are found among those in the Finger Lakes, Capital/Saratoga, and Central New York regions.

#### Race/Ethnicity

```{r}
race_nys = 
  merged %>%
  select(region, nh_white_only_ratio:h_total) %>%
  pivot_longer(
    nh_white_only_ratio:h_total,
    names_to = "race", 
    values_to = "abortion"
    ) %>%
  mutate(
    race = replace(race, race == "nh_white_only_ratio", "Non-Hispanic White Only"),
    race = replace(race, race == "nh_black_only_ratio", "Non-Hispanic Black Only"),
    race = replace(race, race == "nh_other_ratio", "Non-Hispanic Other"),
    race = replace(race, race == "h_total", "Hispanic"),
    race = factor(race)
    ) %>%
  group_by(region,race)%>%
  summarise(total = sum(abortion)) %>% 
  ggplot(aes(x = race, y = total, fill= region, color= region)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right", axis.text.x = element_text(angle = 60, hjust = 1))+
  labs(
    title = "Induced Abortions in NY State by Race/Ethnicity",
    x = "Race/Ethnicity",
    y = "Abortions per 1,000 Live Births"
    )

race_nys 
```

- When looking at abortion rates within different race/ethnicity categories, we observe that the highest rates of abortion are among those who identify as Non-Hispanic Black. 

- The highest rate of abortion is among those residing in New York City and identify as Non-Hispanic Black (4638.1 per 1000 live births). 

- Hispanic individuals also seem to have high rates of abortion, and the highest rate of abortion within this category is among those that reside in the Capital/ Saratoga region (3698.2 per 1000 live births). 


#### Financial Plan Status

```{r}
finance_nys = 
  merged %>%
  select(region, medicaid:not_stated) %>%
  pivot_longer(
    medicaid:not_stated,
    names_to = "finance_plan", 
    values_to = "abortion"
  ) %>% 
  mutate(
    finance_plan = replace(finance_plan, finance_plan == "medicaid", "Medicaid"),
    finance_plan = replace(finance_plan, finance_plan == "self_pay", "Self Pay"),
    finance_plan = replace(finance_plan, finance_plan == "other_insurance", "Other Insurance"),
    finance_plan = replace(finance_plan, finance_plan == "not_stated", "Not Stated"),
    finance_plan = factor(finance_plan)
    ) %>%
  group_by(region,finance_plan)%>%
  summarise(total = sum(abortion)) %>% 
  ggplot(aes(x = finance_plan, y = total, fill= region, color= region)) + 
  geom_bar(stat = "identity", 
           position = "dodge")+
  theme(legend.position = "right")+
  labs(
    title = "Induced Abortions in NY State by Financial Plan Status",
    x = "Financial Plan",
    y = "Abortions per 1,000 Live Births"
    )

finance_nys 
```

- Highest rates of abortion are found among those enrolled in the `Not Stated` insurance category, followed by the `Other Insurance` category. 

- The highest rate of abortion, when stratified by insurance enrollment, is found among those residing in the Capital/Saratoga region, and reporting as `Not Stated` insurance category (168.1k per 1000 live births). 

- Within New York City, highest rates are found among those that are enrolled in `Other Category` insurance plans (150.1k per 1000 live births). 

- Lowest rates of abortion are found among those that are enrolled in Medicaid. 

# Statistical Analysis


If you undertake formal statistical analyses, describe these in detail

# Limiations 

There were a couple of limitations in our project including the amount of limited abortion data in some of the counties. For the race dataset specifically, some of the data was noted as suppressed due to confidentiality. As a result, we had to omit Eastern and Western Adirondacks from our statistical analysis, despite the possibility that there might be valuable information in these regions. Similarly, for the financial plan dataset, there were some plans that had very small cell counts. The plans with small cell counts were eventually omitted as they were not included in the live birth data set, the denominator to calculate abortion rates. As a result, the statistical analysis for financial plan may not show the full scale of the differences between the plans. 

# Discussion


What were your findings? Are they what you expect? What insights into the data can you make?
