---
title: "Explaratory Analysis of Abortion Trend in the Five "
---

```{r, message = FALSE, echo = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(ggridges)
library(patchwork)
library(plotly)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```


## *Total*

First, we want to look at the overall trends in abortion rates in New York City over time (2017-2020). 

```{r, message = FALSE, echo = FALSE}
abortion_year = read_csv("data/abortion_year_borough.csv")

abortion_year %>% 
  filter(borough == "New_York_City") %>% 
  mutate(borough = fct_reorder(borough, total)) %>% 
  knitr::kable()

city_year = abortion_year %>% 
  filter(borough == "New_York_City") %>% 
  mutate(borough = fct_reorder(borough, total)) %>% 
  plot_ly(y = ~total, x = ~year, color = ~borough, type = "scatter", mode = "line", colors = "viridis")

city_year
```


```{r, message = FALSE, echo = FALSE}
abortion_year %>% 
  filter(!borough == "New_York_City") %>% 
  mutate(borough = fct_reorder(borough, total)) %>% 
  knitr::kable()

borough_year = abortion_year %>% 
  filter(!borough == "New_York_City") %>% 
  mutate(borough = fct_reorder(borough, total)) %>% 
  plot_ly(y = ~total, x = ~year, color = ~borough, type = "scatter", mode = "line", colors = "viridis")

borough_year
```


## *Age* 

## *Race* 

## *Finances* 