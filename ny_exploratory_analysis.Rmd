---
title: "New York State Exploratory Analysis"
---

```{r setup, message = FALSE, echo = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(ggridges)
library(patchwork)
library(plotly)

knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

```{r merged data}
merged = read_csv("data/master.csv") %>% 
  janitor::clean_names()
```

### *Total*

```{r NY year}
NY_year = read_csv("data/NY_year.csv")

plot_borough_year = 
  NY_year %>% 
  mutate(borough = fct_reorder(borough, total)) %>% 
  plot_ly(
    y = ~total, x = ~year, color = ~borough, 
    type = "scatter", mode = "line", colors = "viridis") %>% 
   layout(
     title = 'Abortion Rates from 2014-2019 by Regions in NYS', 
     xaxis = list(title = "Year"),
     yaxis = list(title = 'Abortions per 1,000 Live Births'))

plot_borough_year
```

From the plot above, it is evident that, on average, New York City has higher rates of abortions compared to the rest of the regions within New York State. 

## Age 

```{r age nys}
age_plot_nys =
  merged %>% 
  select(region, starts_with("age")) %>% 
  pivot_longer(
    age_less_20:age_plus_40,
    names_to = "age", 
    values_to = "abortion",
    names_prefix = "age_"
  ) %>% 
  mutate(
    age = replace(age, age == "less_20", "<20"),
    age = replace(age, age == "20_24", "20-24"),
    age = replace(age, age == "25_29", "25-29"),
    age = replace(age, age == "30_34", "30-34"),
    age = replace(age, age == "35_39", "35-39"),
    age = replace(age, age == "plus_40", "40+"),
    age = factor(age)
  ) %>%
  group_by(region,age)%>%
  summarise(total = sum(abortion)) %>% 
  plot_ly(
    x = ~age, y = ~total, color = ~region, 
    type = "bar", colors = "viridis") %>% 
  layout(
    title = 'Induced Abortions in NY State by Age', 
    xaxis = list(title = "Age (Years)"),
    yaxis = list(title = 'Abortions per 1,000 Live Births'))

age_plot_nys
```

- From the above plot, it is evident that within different categories of age, the highest abortion rate per 1000 live births is among those that are below 20 years of age. 

- We see a decline in induced abortion rates among older people across all regions within New York State. 

- The highest abortion rate is found among those in New York City who are <20 years. 

- While New York city has higher abortion rates across most age categories, we see that among those that are 35+, higher rates of abortion are found among those in the Finger Lakes, Capital/Saratoga, and Central New York regions.

## Race/Ethnicity

```{r}
race_plot_nys =
  merged %>% 
  select(region, nh_white_only_ratio:h_total) %>%
  pivot_longer(
    nh_white_only_ratio:h_total,
    names_to = "race", 
    values_to = "abortion"
    ) %>%
  mutate(
    race = replace(race, race == "nh_white_only_ratio", "Non-Hispanic White Only"),
    race = replace(race, race == "nh_black_only_ratio", "Non-Hispanic Black Only"),
    race = replace(race, race == "nh_other_ratio", "Non-Hispanic Other"),
    race = replace(race, race == "h_total", "Hispanic"),
    race = factor(race)
    ) %>%
  group_by(region,race)%>%
  summarise(total = sum(abortion)) %>% 
  plot_ly(
    x = ~race, y = ~total, color = ~region, 
    type = "bar", colors = "viridis") %>% 
  layout(
    title = "Induced Abortions in NY State by Race/Ethnicity", 
    xaxis = list(title = "Race"),
    yaxis = list(title = "Abortions per 1,000 Live Births"))

race_plot_nys
```

- When looking at abortion rates within different race/ethnicity categories, we observe that the highest rates of abortion are among those who identify as Non-Hispanic Black. 

- The highest rate of abortion is among those residing in New York City and identify as Non-Hispanic Black. 

- Hispanic individuals also seem to have high rates of abortion, and the highest rate of abortion within this category is among those that reside in the Capital/ Saratoga region. 

## Finacial Plan Status

```{r}
finance_plot_nys= 
  merged %>%
  select(region, medicaid:not_stated) %>%
  pivot_longer(
    medicaid:not_stated,
    names_to = "finance_plan", 
    values_to = "abortion"
  ) %>% 
  mutate(
    finance_plan = replace(finance_plan, finance_plan == "medicaid", "Medicaid"),
    finance_plan = replace(finance_plan, finance_plan == "self_pay", "Self Pay"),
    finance_plan = replace(finance_plan, finance_plan == "other_insurance", "Other Insurance"),
    finance_plan = replace(finance_plan, finance_plan == "not_stated", "Not Stated"),
    finance_plan = factor(finance_plan)
    ) %>%
  group_by(region,finance_plan)%>%
  summarise(total = sum(abortion)) %>% 
  plot_ly(
    x = ~finance_plan, y = ~total, color = ~region, 
    type = "bar", colors = "viridis") %>% 
  layout(
    title = "Induced Abortions in NY State by Financial Plan Status", 
    xaxis = list(title = "Type of Financial Plan"),
    yaxis = list(title = "Abortions per 1,000 Live Births"))

finance_plot_nys
```

- Highest rates of abortion are found among those enrolled in the `Not Stated` insurance category, followed by the `Other Insurance` category. 

- The highest rate of abortion, when stratified by insurance enrollment, is found among those residing in the Capital/Saratoga region, and reporting as `Not Stated` insurance category. 

- Within New York City, highest rates are found among those that are enrolled in `Other Category` insurance plans. 

- Lowest rates of abortion are found among those that are enrolled in Medicaid. 







