---
title: "NY_year_county"
author: "Maisie Sun"
date: "2022-12-09"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(data.table)
library(janitor)
library(ggridges)
library(patchwork)
library(readxl)
library("writexl")
library(rvest)
library(httr)
library(dplyr)
library(plotly)
knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Induced Abortions in Years (2019)

```{r data_import_2019}
url = "https://www.health.ny.gov/statistics/vital_statistics/2019/table21.htm"
url1= "https://www.health.ny.gov/statistics/vital_statistics/2019/table07.htm"
induced_abortion_2019 = 
  read_html(url) %>%
  html_table(header = FALSE) %>%
  first() %>%
  janitor::clean_names()
live_birth_2019 = 
  read_html(url1) %>%
  html_table(header = FALSE) %>%
  first() %>%
  janitor::clean_names()
```

data cleaning

```{r data_cleaning_2019, echo = FALSE}
clean_ia_2019 = 
  induced_abortion_2019 %>%
  select(1:2) %>%
  purrr::set_names(c("county", "total")) %>%
  slice(7:11, 14:70) %>% 
  mutate(total = str_replace(total, ",", ""),
    year="2019") %>%
  mutate_at(c("total", "year"), as.numeric) %>%
     group_by(county, year) %>% 
  summarize(total_rate= sum(total))

clean_lb_2019 = 
  live_birth_2019  %>%  
  select(1:2) %>%
  purrr::set_names(c("borough", "total")) %>%
  slice(7:11, 14:70) %>% 
  mutate(total = str_replace(total, ",", ""),
    year="2019") %>%
  mutate_at(c("total", "year"), as.numeric) %>%
    transform(borough=gsub(pattern="", replacement="New York City", borough)) %>% 
    group_by(county, year) %>% 
  summarize(total_rate= sum(total))
```
